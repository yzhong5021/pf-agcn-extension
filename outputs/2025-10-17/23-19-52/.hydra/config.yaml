data_config:
  sources:
    seqs_train_url: null
    seqs_train_path: C:\Users\yoche\OneDrive - The University of Texas at Austin\Documents\pf_agcn\data\raw\toy_train.fasta
    terms_train_url: null
    terms_train_path: C:\Users\yoche\OneDrive - The University of Texas at Austin\Documents\pf_agcn\data\raw\terms_train_toy.tsv
    seqs_val_url: null
    seqs_val_path: C:\Users\yoche\OneDrive - The University of Texas at Austin\Documents\pf_agcn\data\raw\toy_val.fasta
    terms_val_url: null
    terms_val_path: C:\Users\yoche\OneDrive - The University of Texas at Austin\Documents\pf_agcn\data\raw\terms_val_toy.tsv
    seqs_test_url: null
    seqs_test_path: C:\Users\yoche\OneDrive - The University of Texas at Austin\Documents\pf_agcn\data\raw\toy_test.fasta
    terms_test_url: null
    terms_test_path: C:\Users\yoche\OneDrive - The University of Texas at Austin\Documents\pf_agcn\data\raw\terms_test_toy.tsv
    ia_url: null
    ia_path: C:\Users\yoche\OneDrive - The University of Texas at Austin\Documents\pf_agcn\data\raw\ia.txt
    go_url: null
    go_path: C:\Users\yoche\OneDrive - The University of Texas at Austin\Documents\pf_agcn\data\raw\go-basic.obo
  train_csv: data/splits/train.csv
  val_csv: data/splits/val.csv
  test_csv: data/splits/test.csv
  embeddings_npz: ${system.cache_dir}/esm1b_cafa.npz
  go_prior_npz: ${system.cache_dir}/go_prior_cafa.npz
  go_prior:
    obo_path: ${hydra:runtime.cwd}/data/ontology/go-basic.obo
    train_split_csv: ${..train_csv}
    top_k:
      MF: 100
      BP: 100
      CC: 100
  batch_size: 64
  train_manifest: null
  val_manifest: null
  test_manifest: null
task:
  num_functions: null
  vocab_size: 21
  pad_index: 0
model:
  seq_embeddings:
    cache_path: null
    feature_dim: 128
    seq_len: 512
    dtype: float32
  prot_prior:
    cache_path: null
    top_p_mass: 0.9
    temperature: 1.0
    symmetric: true
  go_prior:
    cache_path: null
    top_p_mass: 0.9
    temperature: 1.0
    symmetric: true
  dccn:
    channels: 64
    kernel_size: 3
    dilation: 2
    dropout: 0.1
  seq_gating:
    shared_dim: 128
    esm_dim: 128
    dccn_channels: 64
    attn_hidden: 128
    dropout: 0.1
  seq_final:
    metric_dim: 64
    graph_dim: 128
  adaptive_protein:
    feature_dim: 128
    attention_dim: 128
    steps: 2
    top_p_mass: 0.9
    temperature: 1.0
    dropout: 0.1
  adaptive_function:
    feature_dim: 128
    attention_dim: 128
    steps: 1
    top_p_mass: 0.9
    temperature: 1.0
    dropout: 0.1
  head:
    feature_dim: 128
    dropout: 0.1
  loss:
    name: bce_with_logits
    pos_weight: null
train:
  training:
    seed: 10
    max_epochs: 3
    gradient_clip: 1.0
    precision: 32
    accumulate_batches: 1
    log_interval: 10
    devices: 1
    accelerator: auto
    strategy: null
    deterministic: true
    enable_progress_bar: true
    limit_train_batches: 0.5
    limit_val_batches: 1.0
    fast_dev_run: false
  optimizer:
    name: adamw
    lr: 0.001
    weight_decay: 0.01
    betas:
    - 0.9
    - 0.999
  scheduler:
    name: cosine
    warmup_epochs: 1
    min_lr: 5.0e-05
  data:
    train_manifest: null
    val_manifest: null
    test_manifest: null
    batch_size: 4
    num_workers: 2
    pin_memory: false
    drop_last: false
  evaluation:
    metric: fmax
    val_interval: 1
    threshold_grid:
    - 0.3
    - 0.5
    - 0.7
eval:
  thresholding:
    mode: per_class
    grid:
    - 0.05
    - 0.1
    - 0.15
    - 0.2
    - 0.25
    - 0.3
  metrics:
  - fmax
  - pr_auc_micro
  - pr_auc_macro
  dump:
    predictions_dir: outputs/preds/${now:%Y%m%d-%H%M%S}
    curves: true
hpo:
  study:
    name: pf_agcn_dev
    storage: sqlite:///results/optuna_dev.db
    direction: maximize
    sampler: tpe
    pruner: median
    n_trials: 60
    timeout_minutes: 720
    seed: 2025
  search_space:
    optimizer.lr:
      type: float
      low: 3.0e-05
      high: 0.003
      log: true
    optimizer.weight_decay:
      type: float
      low: 0.0001
      high: 0.05
      log: true
    model.seq_gating.dropout:
      type: float
      low: 0.05
      high: 0.35
    model.seq_gating.shared_dim:
      type: categorical
      choices:
      - 128
      - 192
      - 256
      - 320
    model.adaptive_protein.top_p_mass:
      type: float
      low: 0.6
      high: 0.95
    model.adaptive_protein.steps:
      type: int
      low: 2
      high: 4
    model.adaptive_function.steps:
      type: int
      low: 1
      high: 3
    scheduler.warmup_epochs:
      type: int
      low: 1
      high: 8
  constraints:
    max_parameters: 28000000
    max_gpu_memory_gb: 16
  callbacks:
    prune_patience: 3
    min_epochs: 6
    checkpoint_metric: fmax
system:
  seed: 42
  cudnn_deterministic: true
  cudnn_benchmark: false
  device: cpu
  precision: fp32
  amp: false
  num_workers: 2
  prefetch_factor: 1
  pin_memory: false
  persistent_workers: false
  cache_dir: ${hydra:runtime.cwd}/.cache/local_low
  save_dir: ${hydra:runtime.output_dir}
  checkpoint_dir: ${.save_dir}/checkpoints
  checkpoint_interval_epochs: null
  resume: false
  mlflow:
    tracking_uri: null
    experiment_name: pfagcn_local_low
    artifact_root: null
  distributed:
    enabled: false
    backend: null
    find_unused_parameters: false
    timeout_seconds: 1800
  preemptible:
    enabled: false
    save_on_sigterm: false
    sigterm_grace_seconds: 0
  rebuild_priors: false
  rebuild_embeddings: false
  log_every: 25
  val_every_epochs: 1
  env:
    OMP_NUM_THREADS: 8
    MKL_NUM_THREADS: 8
    NUMEXPR_NUM_THREADS: 8
    TORCH_NUM_THREADS: 8
  hydra:
    run:
      dir: ${hydra:runtime.cwd}/results/local_low/${now:%Y-%m-%d}/${now:%H-%M-%S}
    job:
      chdir: true
    sweep:
      dir: ${hydra:runtime.cwd}/results/local_low/sweeps/${now:%Y-%m-%d}
      subdir: ${now:%H-%M-%S}_${hydra.job.num}
experiment_name: pfagcn_local_low
resume: false
aspect: CC
